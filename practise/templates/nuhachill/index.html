<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nuhachillcare</title>
    {% load static %}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
     <link rel="stylesheet" href="{% static 'css/style.css'%}">
 <nav class="navbar navbar-expand-lg bg-body-tertiary">
    <div class="container-fluid">
      <h1 class="navbar-brand">NUHACHILLCARE<i class="bi bi-tools p-2"></i></h1>
      
      <!-- <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="#">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">Link</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Dropdown
            </a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#">Action</a></li>
              <li><a class="dropdown-item" href="#">Another action</a></li>
              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item" href="#">Something else here</a></li>
            </ul>
          </li>
          <li class="nav-item">
            <a class="nav-link disabled" aria-disabled="true">Disabled</a>
          </li>
        </ul> -->
        <form class="d-flex" role="search">
          <input class="form-control me-2" type="search" placeholder="Search ..." id="searchbox" onkeyup="searchbar()">
        </form>
      </div>
    
  </nav> 
</head>
<body>
 
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-5 ">
                <div class="formclass ">

                <form action="" method="post" class=" mysetup  p-5 border-radius shadow border rounded bg-light mt-3 ">
                    {% csrf_token %}
                    <h3 class="text-center" >Client Details</h3>

                    <div class="form-group">
                    <label for="">NAME</label>
                    <input type="text" name="name" class="form-control" required >
                    </div>
                     <div class="form-group">
                    <label for="" class="mt-2">ADDRESS</label>
                    <input type="text" name="address" class="form-control" required>
                    </div>
                     <div class="form-group">
                    <label for="" class="mt-2">PH_NO</label>
                    <input type="tel" name="ph_no" class="form-control" required>
                    </div>
                     <div class="form-group">
                    <label for="" class="mt-2">AC_BRAND</label>
                    <!-- <input type="text" name="ac_brand" class="form-control"> -->
                     <select name="ac_brand" id="" required class="form-control">
                        <option value="" selected disabled hidden></option>
                           <option value="Daikin">Daikin</option>
                           <option value="Samsung">Samsung</option>
                           <option value="Bluestar">Bluestar</option>
                           <option value="Whirlpool">Whirlpool</option>
                           <option value="Others">Others</option>
                     </select>
                    </div>
                     <div class="form-group">
                    <label for="" class="mt-2">AC_ISSUE</label> 
                    <!-- <input type="text" name="ac_issue" class="form-control"> -->
                     <select name="ac_issue" id="" required class="form-control" onclick="getservicecharge(event)" >
                        <option value="" selected disabled hidden></option>
                        <option value="Cooling Issues"> Cooling Issues</option>
                        <option value="Electrical Problems"> Electrical Problems </option>
                        <option value="Water Leakage">Water Leakage</option>
                        <option value="Noisy Operation">Noisy Operation </option>
                        <option value="Others">Others</option>
                     </select>
                     <div class="form-group">
                       <label for="">Service_charges</label>
                       <input type="number" id="service_amount"name="service_charges" class="form-control">
                     </div>
                    </div>
                     <div class="form-group">
                    <label for="" class="mt-3">SERVICE_DATE</label>
                    <input type="date" name="service_date" class="form-control mt-3" required >
                    </div>
                     <div class="form-group">
                    <label for="" class="mt-3">NXT_SERVICE_DATE</label>
                    <input type="date" name="nxt_service_date" class="form-control mt-3 " >
                    </div>
                     <div class="form-group newupdate">
                        <a href=""><button type="submit" class="btn btn-primary w-100-- mt-3">SUBMIT</button></a>
                        <a href=""><button  onclick="closess(event)" class="btn btn-danger mt-3 w-80">cancel</button></a>

                     </div>
                </form>
                </div>
            </div>
        </div>
    </div>
    

    <div class="btn_click">
    <button onclick="openform()" class="btn btn-primary ">New Customers</button>
    </div>

                

<!-- Create a table for send data from backend to frontend -->

               <div class="table-responsive container-fluid">

                <table class="table table-striped table-bordered table-hover mt-4">
                     <thead class="table-dark">
                         <tr>
                            <th>S.NO</th>
                            <th>NAME</th>
                            <th>ADDRESS</th>
                            <th>PH_NO</th>
                            <th>AC_BRAND</th>
                            <th>AC_ISSUE</th>
                            <th>Service_charges</th>
                            <th>SERVICE_DATE</th>
                            <th>NXT_SERVICE_DATE</th>
                            <th>UPDATE</th>
                            <th>DELETE</th>
                         </tr>
                     </thead>
                     <tbody id="alldatas">
                            {% for i in datavalue %}
                            <tr>
                            <td >{{forloop.counter}}</td>
                            
                            <td>{{i.para_name}}</td>
                            <td>{{i.para_address}}</td>
                            <td>{{i.para_ph_no}}</td>
                            <td>{{i.para_ac_brand}}</td>
                            <td>{{i.para_ac_issue}}</td>
                            <td>{{i.para_service_charges}}</td>
                            <td>{{i.para_service_date}}</td>
                            <td>{{i.para_nxt_service_date}}</td>
                            <td><a href="{% url 'updatedata' i.id %}" class=""><i class="bi bi-pencil-square fs-6"></i></a></td>
                            <td><a href="{% url 'deletedata' i.id %}" class=""><i class="bi bi-trash fs-6"></i></a></td>
                        </tr>
                        {% endfor %}
                     </tbody>
                </table>
                </div>
            </div>
        </div>
    
    <script>
       function openform(){
      
        const form =document.getElementsByClassName("formclass")[0]
        form.style.display="block"
       }
       
       function closess(event){
        event.preventDefault();
       
        const form =document.getElementsByClassName("formclass")[0]
        form.style.display="none"
       }



    </script>


<!-- For search function -->

<script>

// i am using this function to get the service for the required service 

async function getservicecharge (event){


const data=event.target.value

const values={"requiredservice":data}
const response= await fetch("http://localhost:8000/getserviceamount/",{
  method:"POST",headers:{
   "Content-Type":"application/json" 
  },
  // paking the data
  body:JSON.stringify(values)
})

if (response.ok){
  // unpaking the data
const getdata= await response.json()
console.log(getdata.amount)
const service=document.getElementById("service_amount")
console.log(service)
service.value=getdata.amount

}

}


// ending this---------------------------------------------------------











    function searchbar(){
      let specific_data=document.getElementById("searchbox").value.toLowerCase();
      let whole_data=document.getElementById("alldatas");
      let final_data=whole_data.querySelectorAll("tr")
    
      final_data.forEach(data => {
        let data_check=data.innerText.toLowerCase();
        if (data_check.includes(specific_data)){
          data.style.display="";
        }
        else{
          data.style.display="none";
        }

      });
    
    }
</script>
    
</body>
</html>  